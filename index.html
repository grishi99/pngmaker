<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transparent Image Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2937; /* Dark background */
            color: #f3f4f6;
        }
        /* Custom checkerboard background for transparency preview */
        .checkerboard {
            background-image: linear-gradient(45deg, #374151 25%, transparent 25%),
                              linear-gradient(-45deg, #374151 25%, transparent 25%),
                              linear-gradient(45deg, transparent 75%, #374151 75%),
                              linear-gradient(-45deg, transparent 75%, #374151 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            border: 2px solid #4b5563;
        }
    </style>
</head>
<body class="p-4 sm:p-8 min-h-screen flex items-start justify-center">

    <div class="w-full max-w-4xl bg-gray-800 p-6 sm:p-8 rounded-xl shadow-2xl">
        <h1 class="text-3xl font-bold mb-6 text-center text-emerald-400">
            Transparent PNG Generator
        </h1>
        <p class="text-center text-gray-400 mb-8">
            Select an aspect ratio or define a custom size to create a fully transparent PNG. Max resolution is 2048px on any side.
        </p>

        <!-- Configuration Section -->
        <div class="mb-8 p-6 bg-gray-700 rounded-lg">
            <h2 class="text-xl font-semibold mb-4 text-gray-200">1. Select Output Size</h2>

            <!-- Aspect Ratio Dropdown -->
            <label for="ratio-selector" class="block text-sm font-medium text-gray-400 mb-2">Predefined Aspect Ratio</label>
            <select id="ratio-selector" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500 text-white">
                <optgroup label="Standard Ratios">
                    <option value="1:1" data-w="1024" data-h="1024" selected>1:1 (Square, 1024x1024)</option>
                    <option value="16:9" data-w="1920" data-h="1080">16:9 (Widescreen, 1920x1080)</option>
                    <option value="9:16" data-w="1080" data-h="1920">9:16 (Vertical Video, 1080x1920)</option>
                    <option value="4:3" data-w="1024" data-h="768">4:3 (Traditional, 1024x768)</option>
                    <option value="3:4" data-w="768" data-h="1024">3:4 (Portrait, 768x1024)</option>
                    <option value="4:5" data-w="1000" data-h="1250">4:5 (Social Feed, 1000x1250)</option>
                    <option value="5:4" data-w="1250" data-h="1000">5:4 (Photography, 1250x1000)</option>
                    <option value="3:2" data-w="1200" data-h="800">3:2 (DSLR, 1200x800)</option>
                </optgroup>
                <optgroup label="Document Sizes (Scaled)">
                    <!-- A4 Ratio: ~1:1.414 -->
                    <option value="A4" data-w="1240" data-h="1754">A4 (1240x1754)</option>
                    <!-- A3 Ratio: ~1:1.414 (Max height 2048) -->
                    <option value="A3" data-w="1448" data-h="2048">A3 (1448x2048)</option>
                    <!-- Letter Ratio: ~1:1.294 -->
                    <option value="Letter" data-w="1275" data-h="1650">US Letter (1275x1650)</option>
                </optgroup>
                <optgroup label="Custom">
                    <option value="Custom" data-w="800" data-h="800">Custom Size</option>
                </optgroup>
            </select>

            <!-- Custom Ratio Inputs -->
            <div id="custom-inputs-container" class="mt-6 hidden">
                <h3 class="text-lg font-semibold mb-3 text-gray-200 flex items-center">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 text-emerald-400"><path d="M4 22h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2z"/><path d="M9 22V4"/><path d="M15 22V4"/><path d="M2 9h20"/><path d="M2 15h20"/></svg>
                    Define Custom Size (1px - 2048px)
                </h3>
                <div class="flex flex-col sm:flex-row gap-4">
                    <input type="number" id="custom-width" placeholder="Width (e.g., 1024)" min="1" max="2048" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500" value="800">
                    <input type="number" id="custom-height" placeholder="Height (e.g., 512)" min="1" max="2048" class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500" value="800">
                </div>
            </div>
        </div>

        <!-- Preview and Download Section -->
        <div class="p-6 bg-gray-700 rounded-lg">
            <h2 class="text-xl font-semibold mb-4 text-gray-200">2. Preview & Download</h2>

            <!-- Current Dimensions Display -->
            <div class="flex justify-between items-center mb-6 p-3 bg-gray-800 rounded-lg border border-gray-600">
                <span class="text-gray-400 font-medium">Selected Output Size:</span>
                <span id="output-dimensions" class="text-xl font-bold text-emerald-300">1024px x 1024px</span>
            </div>

            <!-- Preview Area -->
            <div class="mb-6 relative w-full pt-[100%] rounded-lg overflow-hidden bg-gray-900 checkerboard shadow-inner">
                <div id="preview-aspect-container" class="absolute inset-0 flex items-center justify-center">
                    <p class="text-gray-400 italic text-sm">
                        Preview of selected dimensions (Transparent Area)
                    </p>
                </div>
            </div>

            <!-- Download Button -->
            <button id="download-btn" class="w-full py-4 text-lg font-bold bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl transition shadow-lg shadow-emerald-700/50 flex items-center justify-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                Download Transparent PNG
            </button>
        </div>
    </div>

    <!-- Toast Notification (for success/error messages) -->
    <div id="toast" class="fixed bottom-4 right-4 bg-gray-900 text-white p-4 rounded-lg shadow-xl hidden transition transform duration-300 ease-out z-50"></div>

    <script>
        // Global variables to store the current selected size
        let currentWidth = 1024;
        let currentHeight = 1024;
        const MAX_DIMENSION = 2048;

        /**
         * Utility to display temporary messages.
         * @param {string} message - The message to display.
         * @param {string} type - 'success' or 'error'.
         */
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.remove('hidden', 'bg-red-700', 'bg-gray-900', 'translate-y-full');
            toast.classList.add(type === 'error' ? 'bg-red-700' : 'bg-gray-900', 'translate-y-0');

            setTimeout(() => {
                toast.classList.add('hidden', 'translate-y-full');
                toast.classList.remove('translate-y-0');
            }, 3000);
        }

        /**
         * Updates the displayed dimensions and the preview container aspect ratio.
         */
        function updateDimensionsAndPreview() {
            // 1. Update the dimension display
            document.getElementById('output-dimensions').textContent = `${currentWidth}px x ${currentHeight}px`;

            // 2. Update the preview aspect ratio using padding-top trick
            const previewContainer = document.querySelector('.relative.w-full');

            if (currentWidth > 0 && currentHeight > 0) {
                // Calculate the percentage height based on width
                const aspectRatioPercentage = (currentHeight / currentWidth) * 100;
                previewContainer.style.paddingTop = `${aspectRatioPercentage.toFixed(2)}%`;
            } else {
                // Default to 1:1 if inputs are invalid or zero
                previewContainer.style.paddingTop = '100%';
            }
        }

        /**
         * Handles selection from the dropdown.
         */
        function handleRatioSelect(event) {
            const selector = event.target;
            const selectedOption = selector.options[selector.selectedIndex];
            const customInputsContainer = document.getElementById('custom-inputs-container');
            const customW = document.getElementById('custom-width');
            const customH = document.getElementById('custom-height');

            if (selectedOption.value === 'Custom') {
                // Show custom inputs
                customInputsContainer.classList.remove('hidden');
                
                // Read dimensions from custom inputs (or initial values)
                let w = parseInt(customW.value, 10);
                let h = parseInt(customH.value, 10);
                
                currentWidth = w > 0 ? w : 800;
                currentHeight = h > 0 ? h : 800;

            } else {
                // Hide custom inputs
                customInputsContainer.classList.add('hidden');
                
                // Read dimensions from data attributes
                currentWidth = parseInt(selectedOption.dataset.w, 10);
                currentHeight = parseInt(selectedOption.dataset.h, 10);
            }
            
            updateDimensionsAndPreview();
        }

        /**
         * Handles changes in the custom width/height input fields.
         */
        function handleCustomInput() {
            const customW = document.getElementById('custom-width');
            const customH = document.getElementById('custom-height');

            let w = parseInt(customW.value, 10);
            let h = parseInt(customH.value, 10);

            // Validation (keep within min/max, default to a safe value if invalid)
            w = isNaN(w) || w < 1 ? 1 : Math.min(w, MAX_DIMENSION);
            h = isNaN(h) || h < 1 ? 1 : Math.min(h, MAX_DIMENSION);

            // Update global dimensions
            currentWidth = w;
            currentHeight = h;

            // Update the input fields with corrected/clamped values (good UX)
            customW.value = currentWidth;
            customH.value = currentHeight;

            updateDimensionsAndPreview();
        }

        /**
         * Generates the transparent PNG and triggers the download.
         */
        function downloadImage() {
            if (currentWidth <= 0 || currentHeight <= 0) {
                showToast("Please select a valid width and height.", 'error');
                return;
            }

            // 1. Create an in-memory canvas
            const canvas = document.createElement('canvas');
            canvas.width = currentWidth;
            canvas.height = currentHeight;

            const context = canvas.getContext('2d');

            // 2. Ensure transparency: Clearing the canvas is essential for a truly transparent PNG.
            // The canvas is transparent by default, but this is a clear declaration.
            context.clearRect(0, 0, currentWidth, currentHeight);

            // 3. Get the PNG data URL
            // Note: toDataURL('image/png') automatically handles the alpha channel.
            const dataURL = canvas.toDataURL('image/png');

            // 4. Trigger download using a temporary anchor element
            const link = document.createElement('a');
            link.href = dataURL;
            link.download = `transparent_image_${currentWidth}x${currentHeight}px.png`;

            // Append link, click it, and remove it immediately
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showToast(`Successfully generated and downloaded transparent PNG (${currentWidth}x${currentHeight}px)!`);
        }

        // --- Initialization ---
        function initialize() {
            // Setup ratio selector dropdown
            document.getElementById('ratio-selector').addEventListener('change', handleRatioSelect);

            // Setup custom inputs
            document.getElementById('custom-width').addEventListener('input', handleCustomInput);
            document.getElementById('custom-height').addEventListener('input', handleCustomInput);

            // Setup download button
            document.getElementById('download-btn').addEventListener('click', downloadImage);

            // Initial setup (starts with 1:1, calls handleRatioSelect to set dimensions)
            handleRatioSelect({ target: document.getElementById('ratio-selector') });
            updateDimensionsAndPreview();
        }

        // Run initialization when the window loads
        window.onload = initialize;
    </script>
</body>
</html>
